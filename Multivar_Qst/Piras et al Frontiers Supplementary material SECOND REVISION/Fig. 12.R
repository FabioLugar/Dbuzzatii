source("YOUR PATH/Piras et al Frontiers ancillary functions.R")  #### type in your path to the source file

###### Coordinates of Archaeopotamus harvardi
init<-matrix(c(-0.247024325204475, -0.23030381376909, -0.209806919638609, -0.177702899468478, -0.142215450997639, -0.10544705079299, -0.0695588608415263, -0.037445778853776, -0.0090710480332805, 0.0561484607839256, 0.0763062760621776, 0.087947206426753, 0.100961309857946, 0.106863584445217, 0.104212079589966, 0.0912877232322329, 0.0751943353765942, 0.062187516862071, 0.0259798603394352, 0.00614480583023339, -0.0197913587091032, -0.0528366361331508, -0.0948154371453697, -0.121638210071606, -0.131920914474027, -0.14536522451865, -0.167426567071183, -0.197493969451905, -0.121458356329167, -0.0983377843229876, -0.0731856244153847, -0.049787163111478, -0.0260193647895404, 0.000305705217908769, 0.0250944272826576, 0.0456253786494152, 0.0632432599369152, 0.083927930747789, 0.0452639825388521, 0.233638075494944, 0.234849777590118, 0.233643360517838, 0.206522496487917, 0.178072326442684, 0.151676263844847, 0.127920664388248, 0.105635950196731, 0.0426174393821441, 0.0851961404851939, 0.107259637744655, 0.112528002280742, 0.102101120762814, 0.092305525076528, 0.0859015832674373, 0.0793619721622523, 0.0800767198986505, 0.0739798468891791, 0.0713806129493906, 0.0660325003251314, 0.0484218248972892, 0.0293139638625885, 0.00753210786214254, -0.0110887462195655, -0.0166389638402022, -0.0165728759326374, -0.0165654744211965, -0.0291294976264102, -0.0456408853733176, -0.0565127539972351, -0.0612463914963245, -0.0467790739440516, -0.0269644509920969, -0.00617556078308454, 0.0150299461647201, 0.0196794028927351, -0.114340576532338, -0.111982905629759, -0.112010410476676, -0.109191294932923, -0.0989835590598273, -0.0903145242523986, -0.0826285971254108, -0.0782133535265147, -0.0730858513074074, -0.0769246273221248, -0.115548045741305, -0.109514685220598, -0.0237740770163658, 0.0643785681563626, 0.0644072596780768, 0.0682333687154975, 0.0693910228630088, 0.0718599658175388, 0.0728386506356914),ncol=2)
######Coordinates of Hippopotamus amphibius
fin<-matrix(c(-0.233284800058838, -0.215930334148514, -0.193718391899262, -0.162787373526284, -0.129583110788749, -0.0960404572597932, -0.0642567295906873, -0.0353569122869469, -0.00954310873024269, 0.0447266703638312, 0.0804751911921875, 0.0952374608260644, 0.0952241444934102, 0.0975208812922354, 0.0947720892461336, 0.0855471893716, 0.0714396641364137, 0.0587843164746227, 0.000565761616929788, -0.0217828789511062, -0.0474925337362004, -0.0768693644938395, -0.108869377982133, -0.122312358300239, -0.130994869562239, -0.143149188658516, -0.165562748232603, -0.194586833040598, -0.0762038005422427, -0.0663683408368148, -0.0549329355432385, -0.0426462887505601, -0.0275393512212906, -0.00871909712950494, 0.0102296142567627, 0.0277136046784755, 0.0436540872989817, 0.0630754215481296, 0.0581885353129232, 0.2484142132097, 0.238690683483247, 0.228775244797409, 0.205074340918239, 0.180136051990475, 0.157053680015052, 0.134632622718781, 0.108599716028839, 0.053604866811954, 0.0775564339476152, 0.0873077070306437, 0.0900101837891015, 0.0819963098912301, 0.0740562847128187, 0.0658752544895054, 0.065581202875228, 0.0784496367231004, 0.0993978113309246, 0.0892792287276416, 0.0685417096859262, 0.0520106032064704, 0.0464236526060169, 0.0361954706112161, 0.0196146858109612, 0.0102473067725221, 0.00763257832122992, 0.0170157866114056, -0.000471642485580709, -0.0213941199617493, -0.0381714671873656, -0.0483190671745037, -0.0314925923164004, -0.00946922660753959, 0.00900350455851903, 0.0260618436338573, 0.0326552960379394, -0.149127419536015, -0.139723724791422, -0.129064520571283, -0.118724797640126, -0.107471028707084, -0.0967384620929748, -0.0867550620772691, -0.0826424447992654, -0.0791460350891641, -0.0774667495959533, -0.170133647146838, -0.144028289835112, -0.0426864428261861, 0.0766393493680091, 0.0720790120855427, 0.0683943778133502, 0.0615006027059712, 0.0548251429425569, 0.0510708973405746),ncol=2)
### do OPA
fin<-rotonto(init,fin)$yrot

links<-list(c(8,9),c(9,10),c(1,28),c(1,2),c(2,3),c(3,4),c(4,5),c(5,6),c(6,7),c(7,8),c(9,19),c(19,20),c(20,21),c(21,22),c(22,23),c(23,24),c(24,25),c(25,26),c(26,27),c(27,28),c(28,29),c(29,30),c(30,31),c(31,32),c(32,33),c(33,34),c(34,35),c(35,36),c(36,37),c(37,38),c(38,39),c(39,40),c(40,41),c(41,42),c(42,43),c(43,44),c(44,45),c(45,46),c(46,47),c(47,12),c(10,11),c(11,12),c(12,13),c(13,14),c(14,15),c(15,16),c(16,17),c(17,18),c(18,19))

####### Build, individually, panels of Fig. 12 (excluding of course the first row with photos)

### Fig. 12 second row left panel
obi<-psl2d(init,fin,links,mag=0.01,ar=250,alpha=1,log=T,st=F,plotlegend=F,zlim=c(-3,2))
gradientLegend2(c(-3,2),depth=0.02,pos=0.6,notvals = 0,side=4,color=obi$colors)

### Fig. 12 second row right panel
obi<-psl2d(init,fin,links,mag=0.01,ar=250,alpha=1,log=T,st=F,plotlegend=F,zlim=c(-3,2),interpfin=T,elli=F,elliax=F)
lineplot(obi$fin,links,col=2)
gradientLegend2(c(-3,2),depth=0.02,pos=0.6,notvals = 0,side=4,color=obi$colors)
points(obi$fin,col=2,pch=19)
points(obi$init,col=1,pch=19)

### Fig. 12 third row left panel
obi<-psl2d(init,fin,links,mag=0.01,ar=250,alpha=1,log=T,st=F,plotlegend=F,interpfin=T,elli=F,elliax=F,send=T,zlim=c(-10,0))
lineplot(obi$fin,links,col=2)
gradientLegend2(c(-10,0),depth=0.02,pos=0.6,notvals = 0,side=4,color=obi$colors)
points(obi$fin,col=2,pch=19)
points(obi$init,col=1,pch=19)

### Fig. 12 third row right panel
obi<-psl2d(init,fin,links,mag=0.01,ar=250,alpha=1,log=T,st=F,plotlegend=F,interpfin=T,elli=F,elliax=F,bebs=T)
lineplot(obi$fin,links,col=2)
gradientLegend2(c(0,15),depth=0.02,pos=0.6,notvals = 0,side=4,color=obi$colors)
points(obi$fin,col=2,pch=19)
points(obi$init,col=1,pch=19)

### Fig. 12 fourth row left panel
obi<-psl2d(init,fin,links,mag=0.01,ar=300,bebs=F,log=T,plotgrid1=F,plotgrid2=T,plotri1=F,plotri2=F,elli=F,colp="violet",onlyprinc=F,plotelliax1=T,plotelliax2=T,plotlegend=F,la=0,slcoleig=T,colorsleig=c("black","cyan","violet","blue","red"))
gradientLegend2(round(sqrt(c(obi$tpsjacob$cjacps)),2),color=obi$colorsleig,notvals=1,pos=0.6,side=4,fit.margin = T,dec=2,depth=0.02)
lineplot(obi$fin,links,col=2)
points(obi$fin,col=2,pch=19)
points(obi$init,col=1,pch=19)

### Fig. 12 fourth row right panel
obi<-psl2d(init,fin,links,mag=0.01,ar=300,bebs=F,log=T,plotgrid1=F,plotgrid2=T,plotri1=F,plotri2=F,elli=F,colp="violet",onlyprinc=T,plotelliax1=F,plotelliax2=F,plotlegend=F,la=0,slcoleig=T,colorsleig=c("black","cyan","violet","blue","red"))
gradientLegend2(round(sqrt(c(obi$tpsjacob$cjacps)),2),color=obi$colorsleig,notvals=1,pos=0.6,side=4,fit.margin = T,dec=2,depth=0.02)
lineplot(obi$fin,links,col=2)
points(obi$fin,col=2,pch=19)
points(obi$init,col=1,pch=19)





